---
# zuul.d/layout.yaml

- job:
    name: molecule-vagrant-fedora
    description: Run py38 tox environment
    parent: ansible-tox-py38
    nodeset: fedora-latest-1vcpu
    attempts: 1
    vars:
      tox_envlist: py38
    timeout: 3600
    # https://github.com/ansible-community/molecule-vagrant/issues/47
    voting: false

- job:
    name: molecule-vagrant-centos
    description: Run py36 tox environment
    parent: ansible-tox-py36
    nodeset: centos-8-1vcpu
    attempts: 1
    vars:
      tox_envlist: py36
    timeout: 3600
    # https://github.com/ansible-community/molecule-vagrant/issues/47
    voting: false

- job:
    name: molecule-vagrant-devel-centos
    description: Run devel tox environment
    parent: ansible-tox-py36
    nodeset: centos-8-1vcpu
    attempts: 1
    vars:
      tox_envlist: devel
    timeout: 3600
    # https://github.com/ansible-community/molecule-vagrant/issues/47
    voting: false

- project:
    templates:
      - publish-to-pypi
    check:
      jobs: &defaults
        - molecule-tox-linters:
            vars:
              test_setup_skip: true
              tox_envlist: lint,packaging
        - molecule-vagrant-centos
        - molecule-vagrant-fedora
        - molecule-vagrant-devel-centos
    gate:
      jobs: *defaults
